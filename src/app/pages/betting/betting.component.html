<div class="betting-page">
  <div class="page-header">
    <h1 class="page-title">Place Your Bets</h1>
    <div class="location-selector">
      <input 
        type="text" 
        [(ngModel)]="location" 
        (keyup.enter)="onLocationChange()"
        placeholder="Choose location..."
        class="location-input"
      />
      <button (click)="onLocationChange()" class="update-btn">Update</button>
    </div>
  </div>

  <div class="betting-table">
    <div class="table-header">
      <div class="header-cell day-header">Day</div>
      <div class="header-cell">Odds</div>
      <div class="header-cell">Conditions</div>
      <div class="header-cell">Temperature</div>
      <div class="header-cell">Bet</div>
    </div>

    <div class="table-body">
      <div *ngFor="let day of days" class="table-row">
        <div class="table-cell day-cell">
          <div class="day-name">{{ day.day }}</div>
          <div class="day-date">{{ day.date | date:'MMM d' }}</div>
        </div>
        
        <div class="table-cell odds-cell">
          <div *ngIf="!day.loading && day.betOptions.length > 0" class="odds-list">
            <div *ngFor="let option of day.betOptions.slice(0, 3)" class="odds-item">
              {{ option.odds }}x
            </div>
          </div>
          <div *ngIf="day.loading" class="loading">Loading...</div>
        </div>

        <div class="table-cell conditions-cell">
          <div *ngIf="day.weatherData" class="conditions">
            <div class="condition-item">{{ day.weatherData.description }}</div>
            <div class="condition-item">{{ day.weatherData.condition }}</div>
          </div>
          <div *ngIf="day.loading" class="loading">Loading...</div>
        </div>

        <div class="table-cell temp-cell">
          <div *ngIf="day.weatherData" class="temperature">
            {{ day.weatherData.temperature }}Â°C
          </div>
          <div *ngIf="day.loading" class="loading">Loading...</div>
        </div>

        <div class="table-cell bet-cell">
          <button 
            *ngFor="let option of day.betOptions.slice(0, 2)"
            (click)="openBetModal(day, option)"
            class="bet-btn"
            [disabled]="day.loading"
          >
            Bet
          </button>
          <div *ngIf="day.loading" class="loading">Loading...</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Betting Modal -->
  <div *ngIf="showModal" class="modal-overlay" (click)="closeModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <button class="modal-close" (click)="closeModal()">&times;</button>
      
      <h2 class="modal-title">Place Your Bet</h2>
      
      <div *ngIf="selectedDay && selectedOption" class="modal-body">
        <div class="bet-info">
          <div class="info-item">
            <span class="info-label">Day:</span>
            <span class="info-value">{{ selectedDay.day }}, {{ selectedDay.date | date:'MMM d' }}</span>
          </div>
          <div class="info-item">
            <span class="info-label">Bet Option:</span>
            <span class="info-value">{{ selectedOption.label }}</span>
          </div>
          <div class="info-item">
            <span class="info-label">Odds:</span>
            <span class="info-value">{{ selectedOption.odds }}x</span>
          </div>
        </div>

        <div class="bet-form">
          <label for="betAmount" class="form-label">Bet Amount ($)</label>
          <input 
            type="number" 
            id="betAmount"
            [(ngModel)]="betAmount" 
            min="1"
            [max]="walletService.getBalance()"
            class="amount-input"
          />

          <div class="payout-info">
            <div class="payout-row">
              <span>Potential Payout:</span>
              <span class="payout-amount">${{ getPotentialPayout() | number:'1.2-2' }}</span>
            </div>
            <div class="payout-row">
              <span>Profit:</span>
              <span class="payout-amount profit">${{ (getPotentialPayout() - betAmount) | number:'1.2-2' }}</span>
            </div>
          </div>

          <div *ngIf="modalMessage" class="modal-message" [ngClass]="'message-' + modalType">
            {{ modalMessage }}
          </div>

          <button 
            class="place-bet-btn"
            (click)="placeBet()"
            [disabled]="betAmount <= 0 || betAmount > walletService.getBalance()"
          >
            Place Bet
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

